@import "tailwindcss";

/* ===================== Base / Theme ===================== */
@layer base {
  :root {
    --bg: #0b1220;
    --card: #101729;
    --muted: #9aa4b2;
    --text: #e6ebf5;
    --brand: #667eea;
    --brand2: #3643ba;
    --ok: #16a34a;
  }
  body {
    @apply bg-[var(--bg)] text-sm;
  }
}

h1 {
  @apply text-3xl font-bold;
}
h2 {
  @apply text-2xl font-bold;
}
h3 {
  @apply text-xl font-bold;
}

/* ===================== Layout Panels ===================== */
@layer components {
  .editor-wrap {
    @apply h-screen w-full flex overflow-hidden p-4 gap-4;
  }
  .panel {
    @apply overflow-y-auto relative bg-[var(--card)] text-[var(--text)] border border-[#1d2640] rounded-[14px] shadow-[0_10px_30px_rgba(0,0,0,0.35)];
    -webkit-overflow-scrolling: touch; /* smooth iOS scrolling */
  }
  .panel h2 {
    @apply m-0 p-0 text-inherit leading-none flex items-center gap-1 border-b border-[#1d2640];
  }
  .panel-body {
    @apply py-[14px] px-4;
  }

  /* ===================== Typography / Helpers ===================== */
  .label {
    @apply text-base font-semibold mb-1.5 text-[#d7def1];
  }
  .help {
    @apply text-xs text-[var(--muted)];
  }
  .row {
    @apply mb-3;
  }
  .separator {
    @apply h-px bg-[#1d2640] my-3;
  }

  /* ===================== Inputs / Buttons ===================== */
  .input,
  .select {
    @apply bg-white text-[#111827];
  }
  .input,
  .select,
  .btn {
    @apply border border-[#27314f] rounded-[10px] py-2 px-3 outline-none;
  }
  .input:focus,
  .select:focus {
    @apply shadow-[0_0_0_2px_rgba(102,126,234,0.35)] border-[#3b49a1];
  }
  .btn {
    @apply inline-flex items-center gap-2 cursor-pointer transition ease-linear duration-150 border border-[#2a3660];
  }
  .btn.primary {
    @apply text-white border-transparent bg-[linear-gradient(135deg,var(--brand),var(--brand2))];
  }
  .btn.import {
    @apply text-white border-transparent text-xs bg-[linear-gradient(135deg,#10b981,#059669)];
  }
  .btn.export {
    @apply text-white border-transparent text-xs bg-[linear-gradient(135deg,#6210b9,#334782)];
  }
  .btn.remove {
    @apply border-[#7f1d1d] hover:bg-[#b91c1c] hover:text-white;
  }
  .btn.add {
    @apply px-5 border-[#065f46] hover:bg-[linear-gradient(135deg,#10b981,#059669)] hover:text-white hover:border-transparent;
  }
  .btn.info {
    @apply text-[#0b1220] border-transparent bg-[linear-gradient(135deg,#60a5fa,#38bdf8)] hover:bg-[linear-gradient(135deg,#93c5fd,#60a5fa)];
  }

  /* ===================== Clear Button ===================== */
  .row-right {
    @apply flex justify-end;
  }
  .input-with-clear {
    @apply flex items-center gap-2;
  }
  .input-with-clear .input {
    @apply flex-1;
  }
  .clear-link {
    @apply border-0 bg-transparent text-[#007bff] cursor-pointer text-xs p-0 hover:text-[#d97706] hover:underline;
  }
  .clear-right {
    @apply ml-auto;
  }

  /* ===================== Cards / Preview ===================== */
  .stack {
    @apply flex gap-2 flex-wrap;
  }
  .card {
    @apply bg-[#0c1428] border border-[#27314f] rounded-[12px] p-2.5;
  }
  .card .head {
    @apply flex justify-between items-center mb-2;
  }
  .badge {
    @apply text-xs text-[#b9c2d0] bg-[#111a31] border border-[#27314f] py-[2px] px-2 rounded-full;
  }
  .preview {
    @apply bg-white border border-gray-200 rounded-[14px] overflow-hidden;
  }
  .preview-viewport-wrap {
    @apply p-4 flex-1 overflow-auto flex items-start justify-center;
  }
  .preview-viewport {
    @apply bg-white border border-gray-200 rounded shadow-sm overflow-hidden;
    width: 100%;
    max-width: 100%;
    display: flex;
    justify-content: center;
  }
  .preview-iframe {
    width: 100%;
    height: 100%;
    border: 0;
  }
  /* viewport presets */
  .preview-viewport--desktop {
    max-width: 900px;
    height: 800px;
  }
  .preview-viewport--tablet {
    max-width: 600px;
    height: 800px;
    transform: scale(0.95);
  }
  .preview-viewport--mobile {
    max-width: 420px;
    height: 800px;
    transform: scale(0.85);
  }
  .preview .title {
    @apply text-xs py-2 px-3 border-b border-gray-200 text-gray-700 bg-gray-50;
  }
  iframe {
    @apply bg-white;
  }

  /* ===================== Color Picker Row ===================== */
  .colorRow {
    @apply gap-2 items-center mt-2;
  }
  .colorRow .hex {
    @apply flex gap-2 items-center;
  }
  .color-square {
    @apply w-7 h-7 box-border cursor-pointer p-0 border-0;
    background: transparent;
  }

  /* ===================== Modal ===================== */
  .modal-backdrop {
    @apply fixed inset-0 bg-[rgba(0,0,0,0.55)] flex items-center justify-center z-50;
  }
  .modal {
    @apply w-[min(920px,92vw)] max-h-[86vh] bg-[#0e162c] text-[#e6ebf5] border border-[#27314f] rounded-[14px] shadow-[0_20px_60px_rgba(0,0,0,0.5)] overflow-hidden;
  }
  .modal .modal-head {
    @apply flex justify-between items-center py-3 px-[14px] border-b border-[#27314f] bg-[linear-gradient(135deg,#101729,#0d1424)];
  }
  .modal .modal-body {
    @apply py-3 px-[14px];
  }
  .modal textarea {
    @apply bg-white text-[#111827] w-full h-[60vh] border border-[#27314f] rounded-[10px] p-3 font-mono;
  }
  .modal .actions {
    @apply flex gap-2 justify-end py-3 px-[14px] border-t border-[#27314f];
  }

  /* ===================== Quill ===================== */
  .ql-container.ql-snow {
    @apply bg-white text-[#111827] border border-slate-700 rounded-b-xl overflow-hidden;
  }
  .ql-toolbar.ql-snow {
    @apply bg-[#131e38] border border-slate-700! border-b-0 rounded-t-xl;
  }
  .ql-editor {
    @apply min-h-[120px] py-3 px-4 text-[#111827] text-sm leading-[1.6];
  }
  .ql-editor.ql-blank::before {
    @apply text-gray-400 not-italic;
  }
  .ql-snow .ql-picker,
  .ql-snow .ql-picker-options .ql-picker-item,
  .ql-snow .ql-picker-label {
    @apply text-slate-200;
  }
  .ql-snow .ql-picker-options {
    @apply bg-[#0b1224]! border-slate-700!;
  }
  .ql-editor a {
    @apply text-blue-300 underline;
  }
  .ql-container.ql-snow:focus-within {
    @apply outline-2 outline-blue-400 outline-offset-0 border-blue-400 rounded-b-xl;
  }

  /* Inline Quill */
  .inline-quill .ql-editor {
    @apply min-h-10 max-h-20 py-2 px-3 overflow-y-auto;
  }
  .inline-quill .ql-container.ql-snow {
    @apply rounded-b-lg;
  }
  .inline-quill .ql-toolbar.ql-snow {
    @apply rounded-t-lg py-1 px-1.5;
  }

  /* ===================== Drag / Sections ===================== */
  .drag {
    @apply cursor-grab select-none text-gray-200;
  }
  .drag-handle {
    @apply bg-transparent border-0 py-0.5 px-2 rounded-md active:cursor-grabbing hover:bg-white/5;
  }
  .ql-editor * {
    -webkit-user-drag: none;
  }
  .paragraph-section {
    @apply mb-2 last:mb-0;
  }

  /* Drag visuals: placeholder and highlight when dragging over a valid target */
  .drag-placeholder {
    height: 10px;
    border-top: 2px dashed rgba(99, 102, 241, 0.9); /* indigo dashed line */
    margin: 6px 0 8px 0;
    border-radius: 2px;
  }

  .card.drag-over {
    box-shadow:
      0 6px 18px rgba(16, 24, 40, 0.25),
      0 0 0 3px rgba(99, 102, 241, 0.08);
    border-color: rgba(99, 102, 241, 0.8);
  }

  /* ===================== Merge Tag Menu ===================== */
  .tag-menu {
    @apply absolute z-[70] min-w-[260px] max-h-60 overflow-auto bg-gray-800 border border-slate-700 rounded-lg shadow-[0_12px_32px_rgba(0,0,0,0.45)];
  }
  .tag-menu .item {
    @apply flex justify-between items-center gap-2.5 py-2 px-2.5 cursor-pointer hover:bg-[#0b1224];
  }
  .tag-menu .item.active {
    @apply bg-[#0b1224];
  }
  .tag-menu .label {
    @apply text-gray-200 text-[13px];
  }
  .tag-menu .val {
    @apply text-blue-300 text-xs font-mono;
  }
  .tag-menu .group-title {
    @apply py-1.5 px-2.5 text-xs font-semibold text-slate-300 border-t border-slate-700;
  }
  .tag-menu .group:first-child .group-title {
    @apply border-t-0;
  }
}

/* ========== Non-@apply bits Tailwind can't express cleanly ========== */
/* Quill SVG strokes/fills & hover states */
.ql-snow .ql-stroke {
  stroke: #e2e8f0;
}
.ql-snow .ql-fill,
.ql-snow .ql-picker .ql-picker-label::before,
.ql-snow .ql-picker .ql-picker-item::before {
  fill: #e2e8f0;
}

.ql-snow .ql-toolbar button:hover .ql-stroke,
.ql-snow .ql-toolbar button:focus .ql-stroke,
.ql-snow .ql-toolbar .ql-picker-label:hover,
.ql-snow .ql-toolbar .ql-picker-item:hover {
  stroke: #fff;
  color: #fff;
}
.ql-snow .ql-toolbar button.ql-active .ql-stroke {
  stroke: #60a5fa;
}
.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke {
  stroke: #cbd5e1;
}

/* ===================== Scrollbars ===================== */
.editor-wrap * {
  scrollbar-width: thin;
  scrollbar-color: var(--muted) var(--bg);
}

.editor-wrap *::-webkit-scrollbar {
  width: 8px;
}

.editor-wrap *::-webkit-scrollbar-track {
  background: var(--bg);
}

.editor-wrap *::-webkit-scrollbar-thumb {
  background: var(--muted);
  border-radius: 6px;
}

.editor-wrap *::-webkit-scrollbar-thumb:hover {
  background: var(--muted);
}
